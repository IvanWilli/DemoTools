# Vector of population for males
pop_m <-
  c(835, 671, 570.999, 544, 552, 550, 513, 487.998, 432.002,
    378.001, 338.001, 295.999, 263.001, 220.999, 156, 92.001, 42.204,
    18.001, 4.331, 0.639, 0.07, 989.592, 880.029, 697.435, 575.575,
    561.146, 595.087, 582.08, 544.567, 507.247, 440.909, 373.935,
    316.617, 265.548, 235.035, 182.951, 110.75, 57.555, 18.737, 5.459,
    0.807, 0.065, 1133.424, 1037.502, 905.664, 698.771, 586.798,
    616.9, 638.007, 615.889, 550.076, 504.215, 430.131, 353.696,
    286.403, 238.634, 194.496, 130.76, 69.399, 26.238, 5.809, 1.011,
    0.083, 1149.519, 1149.942, 1042.707, 897.087, 691.317, 605.519,
    628.132, 641.442, 608.262, 532.131, 486.313, 401.381, 321.04,
    251.388, 197.567, 138.127, 81.716, 32.255, 8.386, 1.152, 0.112,
    959.81, 1167.439, 1166.318, 1054.263, 929.596, 770.233, 655.408,
    649.175, 641.542, 602.148, 513.273, 463.968, 371.397, 286.345,
    203.426, 141.486, 87.742, 38.904, 10.533, 1.647, 0.131, 904.577,
    990.842, 1195.275, 1192.299, 1096.101, 1010.808, 817.203, 673.368,
    657.377, 631.756, 591.218, 483.434, 432.18, 330.595, 237.691,
    147.718, 86.849, 42.396, 13.172, 2.217, 0.2, 914.965, 926.002,
    1008.784, 1224.923, 1217.653, 1099.911, 1019.023, 813.755, 676.39,
    643.237, 614.691, 562.266, 449.355, 383.548, 273.038, 176.289,
    92.764, 43.563, 15.48, 3.067, 0.316, 943.289, 927.824, 937.572,
    1036.631, 1265.185, 1225.442, 1108.122, 1014.48, 806.487, 659.135,
    627.186, 594.356, 527.096, 404.537, 320.095, 205.116, 112.331,
    47.821, 16.391, 3.791, 0.466, 982.718, 980.995, 958.024, 988.65,
    1076.907, 1293.734, 1267.032, 1135.973, 1031.081, 804.56, 654.945,
    615.926, 567.992, 487.466, 348.485, 248.7, 133.025, 58.273, 17.722,
    3.888, 0.553, 1012.228, 1014.939, 1019.3, 1013.749, 1016.987,
    1100.959, 1315.154, 1281.21, 1143.215, 1026.976, 788.317, 641.579,
    592.945, 521.839, 418.599, 270.316, 163.215, 70.003, 21.874,
    4.186, 0.549, 914.063, 1038.649, 1049.297, 1073.621, 1055.672,
    1047.487, 1138.313, 1344.753, 1295.431, 1144.702, 1016.992, 771.165,
    615.065, 550.259, 457.748, 334.624, 185.735, 87.221, 26.085,
    4.898, 0.538, 879.05, 952.912, 1081.565, 1116.92, 1130.826, 1092.34,
    1097.179, 1186.645, 1381.02, 1305.446, 1143.75, 989.552, 751.696,
    577.344, 489.506, 377.661, 245.003, 105.627, 34.645, 6.138, 0.619,
    967.471, 930.238, 993.227, 1141.416, 1220.943, 1218.465, 1152.732,
    1154.005, 1219.105, 1404.229, 1303.056, 1126.891, 960.563, 712.717,
    522.094, 415.611, 295.598, 149.226, 44.788, 8.64, 0.793, 996.168,
    1002.283, 955.049, 1097.332, 1284.199, 1236.929, 1269.189, 1192.192,
    1174.32, 1216.076, 1400.008, 1311.348, 1099.315, 941.078, 652.11,
    452.242, 319.415, 186.665, 65.652, 11.458, 1.11, 1020.925, 1011.765,
    1014.23, 1017.281, 1208.233, 1389.541, 1315.956, 1321.892, 1224.232,
    1189.671, 1215.983, 1380.774, 1275.239, 1047.397, 867.426, 568.286,
    355.943, 205.33, 83.6, 17, 1.474, 1028.191, 1035.869, 1023.388,
    1074.814, 1125.935, 1311.078, 1465.662, 1367.022, 1352.787, 1239.604,
    1191.356, 1203.245, 1346.713, 1220.838, 973.366, 765.273, 455.163,
    235.912, 97.148, 22.528, 2.061, 1035.917, 1043.755, 1047.947,
    1086.086, 1187.203, 1232.794, 1390.453, 1518.531, 1399.596, 1369.011,
    1242.733, 1181.749, 1178.339, 1295.414, 1142.767, 869.016, 624.221,
    310.175, 115.614, 27.037, 2.784, 1045.967, 1052.236, 1056.4,
    1113.398, 1203.477, 1298.811, 1316.2, 1446.37, 1552.621, 1417.392,
    1372.669, 1234.502, 1160.392, 1138.346, 1219.39, 1029.28, 718.949,
    434.576, 156.257, 33.016, 3.417, 1068.682, 1062.337, 1064.906,
    1121.9, 1230.868, 1315.242, 1382.275, 1372.643, 1481.225, 1570.215,
    1421.698, 1364.113, 1214.291, 1124.645, 1077.332, 1107.059, 862.313,
    510.375, 224.598, 45.72, 4.224, 1102.822, 1085.121, 1075.057,
    1130.572, 1239.683, 1342.955, 1399.057, 1438.921, 1408.243, 1499.967,
    1574.252, 1414.059, 1343.384, 1179.959, 1069.144, 985.391, 938.14,
    623.089, 270.065, 67.236, 5.855, 1140.8, 1119.328, 1097.897,
    1140.924, 1248.743, 1352.213, 1427.121, 1456.061, 1474.768, 1428.008,
    1505.633, 1566.169, 1394.527, 1308.152, 1126.043, 984.266, 844,
    689.026, 337.068, 82.618, 8.662)

# Vector of population for females
pop_f <-
  c(801, 645, 554.001, 534, 557.999, 564, 521.001, 478.001,
    410.999, 352.999, 318, 276, 239, 196.998, 147, 92, 49.354, 23.001,
    6.5, 1.164, 0.135, 948.057, 844.618, 670.281, 562.978, 556.695,
    589.153, 595.677, 545.622, 488.336, 410.687, 346.698, 303.994,
    257.339, 222.218, 177.703, 111.516, 66.076, 25.155, 8.267, 1.423,
    0.145, 1082.85, 993.185, 866.81, 675.391, 590.032, 594.559, 626.777,
    624.823, 547.167, 485.337, 406.556, 337.02, 285.388, 243.185,
    202.252, 135.464, 80.488, 34.773, 9.379, 1.88, 0.182, 1091.999,
    1101.593, 998.637, 870.126, 696.038, 607.414, 608.372, 634.123,
    618.287, 534.182, 476.099, 390.902, 323.659, 270.819, 222.629,
    158.211, 99.985, 43.526, 13.425, 2.209, 0.243, 916.285, 1113.846,
    1116.448, 1022.769, 918.839, 752.674, 635.897, 619.411, 627.163,
    613.115, 524.316, 470.068, 384.21, 315.25, 247.486, 184.146,
    119.509, 56.879, 17.577, 3.347, 0.307, 858.616, 944.546, 1141.242,
    1148.666, 1080.544, 977.493, 784.947, 647.137, 627.282, 623.897,
    615.885, 510.514, 460.492, 370.614, 286.566, 207.64, 136.385,
    70.415, 24.027, 4.599, 0.483, 868.926, 877.749, 959.791, 1175.057,
    1195.136, 1093.776, 991.924, 782.722, 651.731, 622.015, 618.687,
    605.778, 500.641, 442.912, 341.607, 245.476, 158.844, 84.752,
    32.378, 7.171, 0.792, 895.173, 880.805, 893.824, 982.635, 1215.112,
    1205.436, 1108.77, 989.171, 783.703, 645.936, 620.163, 616.473,
    594.188, 483.99, 407.959, 294.664, 188.001, 102.344, 41.293,
    10.454, 1.36, 936.591, 930.873, 909.761, 937.09, 1040.314, 1261.087,
    1253.31, 1138.156, 1013.326, 789.43, 647.395, 618.625, 607.737,
    578.414, 450.459, 356.927, 227.408, 122.534, 50.048, 13.221,
    1.968, 962.734, 966.476, 967.107, 957.99, 982.293, 1078.452,
    1289.82, 1276.239, 1152.444, 1021.414, 790.697, 651.846, 612.561,
    584.997, 533.268, 389.96, 277.225, 150.795, 61.026, 16.175, 2.495,
    872.149, 989.229, 998.47, 1014.575, 1007.4, 1019.803, 1118.597,
    1322.793, 1295.408, 1160.933, 1017.656, 782.288, 640.445, 591.004,
    544.271, 468.132, 312.504, 184.648, 74.05, 18.888, 2.818, 831.614,
    907.289, 1032.916, 1054.491, 1087.81, 1064.803, 1079.765, 1163.223,
    1358.369, 1304.687, 1162.716, 1010.927, 777.628, 621.991, 554.866,
    485.032, 385.873, 214.234, 93.771, 23.583, 3.281, 918.838, 876.318,
    944.356, 1087.72, 1156.023, 1189.243, 1155.079, 1142.97, 1200.737,
    1385.864, 1307.092, 1157.85, 1000.01, 756.228, 585.003, 501.751,
    414.881, 275.154, 114.55, 31.799, 4.292, 950.252, 955.845, 901.601,
    1034.682, 1232.517, 1230.147, 1278.363, 1207.768, 1177.793, 1204.356,
    1388.633, 1309.444, 1137.271, 975.544, 718.972, 536.404, 423.543,
    303.137, 151.219, 39.364, 5.675, 972.207, 966.024, 968.771, 971.038,
    1155.236, 1343.606, 1310.409, 1330.404, 1239.077, 1193.687, 1207.497,
    1378.179, 1287.326, 1102.782, 925.427, 657.537, 458.654, 313.372,
    169.081, 52.593, 7.072, 976.405, 987.332, 978.581, 1036.217,
    1088.349, 1263.153, 1421.22, 1360.854, 1360.488, 1254.47, 1197.429,
    1200.365, 1355.979, 1250.443, 1049.613, 850.295, 565.065, 343.486,
    179.947, 59.846, 9.474, 983.61, 992.108, 1000.337, 1048.292,
    1157.406, 1200.03, 1343.652, 1473.399, 1392.3, 1376.507, 1258.974,
    1191.956, 1183.853, 1320.389, 1194.661, 970.4, 737.82, 429.619,
    201.231, 64.936, 11.111, 993.232, 1000.063, 1005.704, 1073.068,
    1174.732, 1273.909, 1284.275, 1398.562, 1506.421, 1409.749, 1381.642,
    1254.544, 1177.896, 1156.569, 1266.895, 1112.005, 851.243, 570.482,
    257.474, 74.251, 12.326, 1014.748, 1009.727, 1013.685, 1078.453,
    1199.539, 1291.299, 1358.178, 1339.471, 1432.104, 1523.907, 1415.474,
    1377.117, 1241.194, 1153.335, 1113.937, 1185.875, 984.267, 667.614,
    348.639, 96.877, 14.172, 1047.114, 1031.299, 1023.389, 1086.588,
    1205.189, 1316.366, 1375.813, 1413.531, 1373.503, 1450.422, 1529.735,
    1411.833, 1363.681, 1217.645, 1114.502, 1048.481, 1058.718, 782.58,
    415.883, 133.756, 18.362, 1083.119, 1063.736, 1045.012, 1096.489,
    1213.687, 1322.39, 1401.18, 1431.462, 1447.757, 1392.552, 1457.502,
    1526.287, 1399.672, 1340.065, 1180.192, 1054.342, 943.985, 853.051,
    496.821, 162.711, 25.414)

# Vector of age-specific fertility rates
asfr <- c(50.369, 202.131, 206.141, 149.211, 87.253, 31.052,
          2.843, 57.919, 226.709, 222.516, 148.992, 87.888, 29.736, 2.64,
          54.096, 223.587, 211.46, 140.311, 76.881, 26.533, 2.132, 45.049,
          159.679, 156.131, 93.96, 50.059, 15.713, 1.409, 37.188, 119.39,
          132.748, 70.029, 28.02, 7.311, 0.514, 30.209, 101.658, 125.692,
          65.483, 19.804, 3.711, 0.243, 24.9, 88.815, 121.231, 68.621,
          20.031, 3.039, 0.163, 23.238, 78.247, 118.743, 75.403, 24.014,
          3.426, 0.129, 25.141, 75.764, 118.592, 85.555, 29.309, 4.303,
          0.136, 20.117, 64.41, 104.081, 85.589, 32.737, 5.247, 0.219,
          14.645, 53.484, 98.176, 92.658, 37.567, 6.397, 0.273, 13.677,
          51.37, 100.418, 104.868, 48.196, 8.278, 0.393, 11.494, 43.287,
          93.809, 106.904, 53.5, 10.662, 0.544, 8.387, 37.053, 86.307,
          106.038, 55.169, 11.345, 0.701, 6.625, 31.576, 80.064, 106.128,
          58.423, 13.087, 0.917, 5.468, 27.869, 76.196, 107.843, 62.296,
          15.036, 1.172, 4.686, 25.34, 73.943, 110.575, 66.487, 17.107,
          1.462, 4.134, 23.539, 72.551, 113.398, 70.423, 19.099, 1.756,
          3.732, 22.206, 71.53, 115.597, 73.588, 20.803, 2.024, 3.467,
          21.39, 71.244, 117.758, 76.268, 22.224, 2.249)

# Vector of survival rates for males
sr_m <- c(0.95557549, 0.9921273, 0.99594764, 0.99510483, 0.99178483,
          0.99134461, 0.99100899, 0.98929784, 0.98473229, 0.97588706, 0.96048519,
          0.93812765, 0.90615821, 0.8622277, 0.8047363, 0.71333856, 0.596832,
          0.44396816, 0.30330032, 0.18642771, 0.0911662462413327, 0.96275471,
          0.99399428, 0.9968488, 0.99563281, 0.99229006, 0.99196446, 0.99180061,
          0.99013625, 0.98594365, 0.97719516, 0.96239426, 0.93950426, 0.90620399,
          0.86117682, 0.80225284, 0.71307413, 0.60022645, 0.4558758, 0.31005161,
          0.18518342, 0.0956313878791117, 0.96951141, 0.99496609, 0.99727649,
          0.99607245, 0.99233725, 0.99205108, 0.99228027, 0.99056435, 0.98605767,
          0.97783685, 0.96314897, 0.9406932, 0.90642888, 0.86286999, 0.80387894,
          0.71498269, 0.6066814, 0.46479967, 0.31958557, 0.19836001, 0.101989015830425,
          0.97545992, 0.99563858, 0.99741385, 0.99592654, 0.99152023, 0.99192115,
          0.9924163, 0.990644, 0.98617665, 0.97752991, 0.96353815, 0.94114166,
          0.90833701, 0.86170391, 0.80301014, 0.72151551, 0.6128495, 0.47608317,
          0.32653048, 0.19655555, 0.103730263806538, 0.98060776, 0.99617149,
          0.99761403, 0.99542383, 0.99054495, 0.99194397, 0.99266261, 0.99089428,
          0.98611279, 0.97789594, 0.96434779, 0.94341044, 0.91191009, 0.86748795,
          0.80686197, 0.72532159, 0.61846149, 0.48319275, 0.33857582, 0.2104904,
          0.112385162790671, 0.98550309, 0.99688352, 0.99803301, 0.9959062,
          0.99126003, 0.99231634, 0.99301369, 0.99160392, 0.98761021, 0.97986329,
          0.96646197, 0.94623899, 0.91718051, 0.87584219, 0.81662218, 0.73700918,
          0.6303803, 0.50160307, 0.3651526, 0.23288489, 0.130850768617506,
          0.98931819, 0.99775357, 0.9984583, 0.99673481, 0.99301824, 0.99346278,
          0.99369545, 0.99294003, 0.98994327, 0.98356936, 0.97206458, 0.95389895,
          0.92644026, 0.88661213, 0.82907732, 0.74960973, 0.64331764, 0.51551648,
          0.37629084, 0.24487989, 0.137677217644374, 0.99112504, 0.99814201,
          0.99879926, 0.99711429, 0.99389061, 0.99409107, 0.99396033, 0.99290953,
          0.99073493, 0.98586868, 0.97625645, 0.95984456, 0.93401387, 0.89576747,
          0.84146086, 0.76230416, 0.6528808, 0.51875327, 0.37059318, 0.23716232,
          0.129879589178461, 0.99268153, 0.99853182, 0.99902021, 0.99755244,
          0.99471893, 0.99453053, 0.99383731, 0.99242559, 0.99039498, 0.98664094,
          0.97888902, 0.96514568, 0.94232807, 0.90695918, 0.85686765, 0.78068285,
          0.6693777, 0.52625072, 0.37539746, 0.23620331, 0.123653858706926,
          0.99378702, 0.99880557, 0.99916867, 0.99795758, 0.99537754, 0.99534488,
          0.99484455, 0.99357678, 0.99141921, 0.9878473, 0.98134482, 0.96932265,
          0.94941573, 0.91742454, 0.86776992, 0.79533967, 0.68311452, 0.5343893,
          0.37262307, 0.2239178, 0.113720633638293, 0.99399248, 0.99897976,
          0.99932852, 0.99822431, 0.99601855, 0.99591387, 0.99569633, 0.99470259,
          0.99268715, 0.98892298, 0.98249955, 0.97238094, 0.9552462, 0.92844911,
          0.88653064, 0.82114141, 0.71875477, 0.56869525, 0.39721252, 0.23529357,
          0.113792166251756, 0.99425766, 0.99909623, 0.99940998, 0.99846006,
          0.99631257, 0.99603178, 0.99592291, 0.99518752, 0.99322132, 0.98983274,
          0.98368064, 0.9741733, 0.9602258, 0.93745239, 0.9016288, 0.8444638,
          0.75222073, 0.60907965, 0.4240168, 0.24939352, 0.117336219766853,
          0.99471736, 0.99933256, 0.99947765, 0.99871556, 0.99694493, 0.99649396,
          0.99655801, 0.99589338, 0.99413263, 0.99084735, 0.98542046, 0.97725847,
          0.96497949, 0.9452114, 0.9134356, 0.8610204, 0.7737601, 0.63147622,
          0.43996206, 0.25585397, 0.117677375365884, 0.99489165, 0.99937715,
          0.99951763, 0.99880472, 0.99710652, 0.99665932, 0.99675852, 0.99614922,
          0.99444005, 0.99122406, 0.98598437, 0.97827319, 0.96683874, 0.94835124,
          0.91833471, 0.86821514, 0.78398104, 0.64282533, 0.44786339, 0.25892654,
          0.117310656081295, 0.99547488, 0.99923281, 0.99957341, 0.99911343,
          0.99802214, 0.99709297, 0.99680896, 0.99635099, 0.99498899, 0.99222347,
          0.9875931, 0.98060053, 0.97014661, 0.9536392, 0.92634894, 0.87987019,
          0.79856151, 0.66278044, 0.47312791, 0.2694788, 0.111570323438865,
          0.99610316, 0.99933917, 0.9996362, 0.99923203, 0.99825186, 0.99737383,
          0.99710434, 0.99670571, 0.99548655, 0.99299216, 0.9888173, 0.98253469,
          0.97316181, 0.95828527, 0.93341992, 0.89062075, 0.81386423, 0.68145805,
          0.49006978, 0.27830681, 0.113218864970809, 0.99653042, 0.99941146,
          0.99967816, 0.99931356, 0.99841616, 0.99758578, 0.9973301, 0.99697294,
          0.99585907, 0.99356834, 0.9897352, 0.98398011, 0.97540572, 0.96174959,
          0.93872789, 0.89876001, 0.8256409, 0.69618678, 0.50377247, 0.28557404,
          0.114591438080939, 0.99688677, 0.99947174, 0.99971275, 0.99938206,
          0.99855794, 0.99777511, 0.99753337, 0.99721139, 0.99619015, 0.99408084,
          0.99055187, 0.98526355, 0.97739317, 0.9648224, 0.94346085, 0.90607063,
          0.83636949, 0.70989474, 0.51681708, 0.29260349, 0.115932510195963,
          0.99718332, 0.99952193, 0.9997412, 0.99943948, 0.99868001, 0.99794372,
          0.99771578, 0.99742349, 0.99648352, 0.99453532, 0.99127626, 0.98639967,
          0.97914803, 0.96753912, 0.94766613, 0.91261037, 0.84609618, 0.7225789,
          0.52915469, 0.29935668, 0.117233382382913, 0.99743526, 0.99956461,
          0.99976514, 0.9994886, 0.99878699, 0.99809597, 0.99788161, 0.99761483,
          0.99674727, 0.99494418, 0.99192807, 0.98742013, 0.98072071, 0.96997658,
          0.95145635, 0.91854221, 0.85503156, 0.73446104, 0.54096047, 0.30591861,
          0.118509238191645)

# Vector of survival rates for females
sr_f <- c(0.854489854276296, 0.935421167801612, 0.97813792986728,
          0.982021189677661, 0.976828336081795, 0.97244561985297, 0.968812772150047,
          0.96483427499772, 0.96010802339363, 0.954056165687121, 0.943306039954761,
          0.92448836548943, 0.890690237758345, 0.835639114030282, 0.754796751406155,
          0.644175707707241, 0.510754359186887, 0.367690608641792, 0.24038748937665,
          0.145450728453873, 0.0826258994519641, 0.872081445760557, 0.944846444000478,
          0.981301676540409, 0.98454923599414, 0.980025670920247, 0.976133157582757,
          0.972813894527646, 0.968976434023376, 0.964396307993652, 0.958650557701456,
          0.948256461919103, 0.930336619590153, 0.898721683064412, 0.846943744756808,
          0.7693050373115, 0.660761281137989, 0.526356065457763, 0.380513624627523,
          0.249631099810745, 0.150641910916079, 0.0845984581684562, 0.886848633625797,
          0.952485090106336, 0.983750072193038, 0.986500893000163, 0.982460467395807,
          0.978978117640805, 0.975938233552867, 0.972378413253193, 0.967941794833695,
          0.962223931611845, 0.952268831689409, 0.935291261627555, 0.905449822961756,
          0.856292233575997, 0.781888442354377, 0.676068647825169, 0.542224475987347,
          0.394762631381521, 0.260252774164775, 0.156857215747202, 0.0874135544568921,
          0.900784558263659, 0.9596839642243, 0.986196123803518, 0.988385232322206,
          0.984769248387878, 0.981657532920333, 0.978917213857464, 0.975642526638743,
          0.971423457946261, 0.965729507599766, 0.956020853088256, 0.939966236835617,
          0.912171280137383, 0.865872642393594, 0.794508147678775, 0.691547047753295,
          0.558414706244368, 0.408689574652693, 0.269878505194327, 0.1624396495176,
          0.0898671492416105, 0.912633835108388, 0.965550681132028, 0.987920059015778,
          0.989848240747598, 0.986695608763104, 0.983981235542121, 0.981570190639542,
          0.97861812228183, 0.974635289736998, 0.9691431860219, 0.959749667932423,
          0.944374872196883, 0.918112298204692, 0.874309263183862, 0.80582736469469,
          0.705435057343639, 0.573891155573389, 0.423123546270893, 0.280818298136084,
          0.169320472983824, 0.0930347806338448, 0.922791200429312, 0.970414095250172,
          0.989432301168788, 0.990708732285749, 0.987862933459543, 0.98554556950358,
          0.983439950663867, 0.980726138018158, 0.976956585172812, 0.971679032024458,
          0.962795297767379, 0.948303265698793, 0.923561621562827, 0.882274284142424,
          0.817184362828982, 0.720298723984997, 0.590336398050365, 0.439061608307152,
          0.293893306863672, 0.178752339638971, 0.0979770657163587, 0.933750711567667,
          0.975650023350237, 0.991430129981753, 0.99247477931302, 0.989942622594004,
          0.987846767986695, 0.98591292962169, 0.983362542545618, 0.979767042495056,
          0.974726611965329, 0.96628359885727, 0.95251185213316, 0.929005505885616,
          0.889790085932051, 0.827762556372604, 0.734212960407364, 0.606322257595734,
          0.453895037584414, 0.305625301261282, 0.186403154530675, 0.101364444633525,
          0.942022185331379, 0.979147123918558, 0.992515619501369, 0.9933310350342,
          0.990999245807151, 0.98905130373017, 0.987257739978207, 0.984897031588263,
          0.981492787306857, 0.9766673141557, 0.968686240948038, 0.955634366723833,
          0.9333801029294, 0.895907358522987, 0.836661271636903, 0.746801163214231,
          0.621415950298903, 0.468910608066693, 0.317915153427838, 0.195039481469627,
          0.105384282613558, 0.94718229582512, 0.980790142908247, 0.992803300931434,
          0.993541163348349, 0.991307476656705, 0.989225443921528, 0.987176469101693,
          0.98460623719428, 0.981246509709472, 0.976718447241337, 0.969160984177711,
          0.956833654346736, 0.935783935128507, 0.900223655022325, 0.843512027545961,
          0.75698552882669, 0.634658767009268, 0.482935300037292, 0.329848456620383,
          0.20331169504299, 0.10978246168398, 0.953756599857967, 0.984059901645376,
          0.993955214747401, 0.994268297381336, 0.991878910452198, 0.989316711233698,
          0.98661050317541, 0.983509725457937, 0.980068840413112, 0.975865841537748,
          0.96873162752321, 0.957191306973029, 0.937336013374256, 0.903694171906013,
          0.84952642553648, 0.76536853834578, 0.645403389194791, 0.494479119379901,
          0.339863899010747, 0.210826549541289, 0.113471459046826, 0.960713535654886,
          0.987033073900882, 0.994716009106623, 0.994894234746082, 0.992525302465177,
          0.9895538842758, 0.986152805334012, 0.982472321949589, 0.979073662581534,
          0.975395328209274, 0.968932259296626, 0.958359612326248, 0.939967835580358,
          0.908680780255339, 0.857541392392623, 0.777353828146545, 0.661131513296524,
          0.512711981039796, 0.357346432815676, 0.224662101978509, 0.121638559000661,
          0.967668081909087, 0.990008068984907, 0.995560889886471, 0.995641991716643,
          0.993624470509278, 0.991059373658537, 0.988040353436121, 0.984673329703723,
          0.981470430737054, 0.977934939728761, 0.971766487949973, 0.961780792273926,
          0.944588362056491, 0.915303175185752, 0.867175365253056, 0.790635307536064,
          0.677656963580601, 0.530729783448463, 0.374404597176352, 0.237203123872316,
          0.127388492872508, 0.973550993968318, 0.99237559671888, 0.996334437474569,
          0.996302569319733, 0.994665042785698, 0.992854350176394, 0.990804628097226,
          0.988299827070781, 0.985427217612243, 0.98180549401774, 0.975726794918091,
          0.966103852460658, 0.949838547130851, 0.92234926803937, 0.877071883537886,
          0.804140728455995, 0.694271895287286, 0.548487335263838, 0.389191763586342,
          0.24733085854494, 0.131770634512774, 0.977644495019607, 0.993809059507753,
          0.996921848401461, 0.996813848508293, 0.995383460235151, 0.993952685083984,
          0.992408034278954, 0.990393195059418, 0.987756840918104, 0.984187864274535,
          0.978346485320431, 0.969132680765175, 0.953701455005333, 0.92763044136048,
          0.884677298385547, 0.814988789377917, 0.708878868603095, 0.565946568832964,
          0.40677396957209, 0.26150417331884, 0.138468877454496, 0.99589669,
          0.99939439, 0.99968965, 0.99946356, 0.99900599, 0.99861604, 0.99832041,
          0.99779148, 0.99668581, 0.9946399, 0.9913872, 0.98672374, 0.97979077,
          0.96855904, 0.94971941, 0.9172498, 0.85796829, 0.74889563, 0.57422822,
          0.35395265, 0.158786622360056, 0.9963443, 0.99946056, 0.99972569,
          0.99951979, 0.99909662, 0.99871978, 0.99844108, 0.9979583, 0.99694158,
          0.99505178, 0.99204825, 0.98775485, 0.98138426, 0.97102475, 0.95351064,
          0.92310744, 0.86661424, 0.76030246, 0.58585433, 0.36085561, 0.160294341407215,
          0.99679414, 0.99952694, 0.99976136, 0.99957681, 0.99919131, 0.99883301,
          0.99857404, 0.99814009, 0.99721897, 0.99549888, 0.99276597, 0.98887133,
          0.98310375, 0.97368874, 0.95762803, 0.92951136, 0.87619312, 0.77320377,
          0.59930763, 0.36898278, 0.162083812814283, 0.9971375, 0.99957757,
          0.99978821, 0.99962071, 0.99926645, 0.99892672, 0.99868509, 0.9982903,
          0.99744714, 0.99586696, 0.99335694, 0.98978824, 0.98451115, 0.97587178,
          0.96101941, 0.93482131, 0.88424374, 0.78427805, 0.61113191, 0.37625625,
          0.163698785477625, 0.99744017, 0.99962217, 0.9998116, 0.99965971,
          0.99933486, 0.99901498, 0.99879044, 0.99843159, 0.99766096, 0.99621214,
          0.99391125, 0.99064648, 0.985825, 0.97791169, 0.9642029, 0.93983665,
          0.89194494, 0.79508552, 0.62293587, 0.38364594, 0.165352911452495,
          0.99771115, 0.99966211, 0.99983233, 0.99969485, 0.99939794, 0.99909887,
          0.9988912, 0.99856572, 0.9978633, 0.996539, 0.9944362, 0.99145779,
          0.98706409, 0.97983722, 0.96722115, 0.94462117, 0.89938678, 0.80574358,
          0.63485152, 0.39124343, 0.167067858821075)


all_years <- c("1950", "1955", "1960", "1965", "1970", "1975",
               "1980", "1985", "1990", "1995", "2000", "2005",
               "2010", "2015", "2020", "2025", "2030", "2035",
               "2040", "2045", "2050")

# Population for males as matrix
pop_m_mat <- matrix(pop_m, nrow = 21, ncol = 21)
colnames(pop_m_mat) <- all_years

# Population for females as matrix
pop_f_mat <- matrix(pop_f, nrow = 21, ncol = 21)
colnames(pop_f_mat) <- all_years

# Age-specific-fertility-rate for as matrix
asfr_mat <- matrix(asfr, nrow = 7, ncol = 20)
colnames(asfr_mat) <- all_years[-length(all_years)]

# Sex ratio at birth as vector
srb_vec <- c(1.058, 1.057, 1.055, 1.055, 1.06, 1.056, 1.056, 1.052, 1.056,
             1.054, 1.054, 1.053, 1.054, 1.053, 1.056, 1.056, 1.056, 1.056,
             1.056, 1.056)

names(srb_vec) <- all_years[-length(all_years)]

# Survival ratio for males as matrix
sr_m_mat <- matrix(sr_m, nrow = 21, ncol = 20)
colnames(sr_m_mat) <- all_years[-length(all_years)]

# Survival ratio for females as matrix
sr_f_mat <- matrix(sr_f, nrow = 21, ncol = 20)
colnames(sr_f_mat) <- all_years[-length(all_years)]

# Age/year sequence of all the data from above
interval <- 5
ages <- seq(0, 100, by = interval)
years <- seq(1950, 2050, by = interval)
ages_fertility <- seq(15, 45, by = interval)

test_that("mig_resid_stock returns correct result", {
  mig_m_correct <- c(1.78993, 51.6027, 29.15413, 7.37114, 21.61505, 47.86478,
                     37.02506, 37.05721, 26.69961, 19.32384, 10.87064, -0.47108, -2.67392,
                     8.26825, 5.10508, -0.53082, 2.64586, -0.00023, -0.00071, -0.00042,
                     0.00036, 3.91902, 53.85321, 28.40815, 4.38183, 15.66065, 60.26311,
                     47.79935, 39.55049, 13.16362, 8.53569, 5.80271, 2.38247, -0.51659,
                     9.95022, 5.9385, 0.30237, 2.92392, 7e-05, -0.00044, 8e-05, -0.00039,
                     -5.85431, 22.22355, 8.03065, -5.01996, -2.09949, 23.38541, 15.9943,
                     9.45501, 0.95993, -5.75358, 0.67884, -3.24031, 0.43973, 4.25945,
                     5.73415, -0.93427, 2.38634, -0.00163, 0.00071, -0.00027, 0.00042,
                     12.90924, 22.93354, 19.34992, 15.80343, 40.11609, 84.50105, 54.48107,
                     26.9198, 8.96688, 7.5537, 0.54448, 6.27858, 6.80778, 9.70358,
                     1.55889, -1.06165, 3.09094, 0.00039, 0.00076, -0.00131, -0.00012,
                     29.21119, 34.70664, 30.62147, 31.31827, 51.80611, 88.70085, 52.6215,
                     23.92796, 17.21723, 4.39468, 10.53791, -0.79311, 9.0829, 8.41258,
                     6.65011, 0.16873, -0.65464, -3e-04, 5e-05, -1e-04, 0.00018, 14.48194,
                     24.2441, 19.89098, 34.54122, 35.77466, 12.23207, 15.27682, 3.4133,
                     11.36489, -0.90259, 4.12285, 2.83248, 5.95876, 5.02652, 3.06679,
                     1.10855, -0.35452, -0.00073, -0.00101, -0.00056, -0.00027, 15.00503,
                     14.9144, 12.99762, 31.14087, 48.81412, 15.74907, 15.14544, 2.65127,
                     0.91571, -6.14148, 1.9181, 8.0029, 6.19014, 6.13341, 2.10405,
                     0.44406, -1.07882, -0.00037, -0.00136, 0.00026, 0.00024, 30.61609,
                     39.45862, 31.31408, 53.78356, 46.60918, 36.02489, 48.99127, 35.70811,
                     26.00023, 9.46973, 11.4602, 13.92493, 12.85525, 15.31055, 8.08295,
                     4.69025, -0.8913, 0.00093, -0.00014, 0.00067, 1e-04, 22.79134,
                     33.66381, 39.26617, 58.06982, 33.55813, 29.94211, 29.39288, 23.77502,
                     18.15304, 9.66927, 0.74205, 9.46166, 12.54064, 6.69344, 0.90515,
                     -1.74026, -3.25923, -0.0015, -0.00154, 0, -0.00015, 33.40944,
                     27.63004, 35.20175, 56.40284, 46.60901, 35.2342, 43.02994, 38.04652,
                     25.21479, 15.38015, 9.17442, 7.03148, 5.93981, 6.27671, 4.91181,
                     1.69561, 1.07822, 0.00065, 0.00027, 2e-05, -0.00047, 35.20631,
                     39.78156, 43.61343, 69.48623, 61.47957, 40.98161, 54.20004, 54.36211,
                     46.10098, 24.36452, 19.0808, 0.64836, 15.04356, 6.28745, 1.68454,
                     1.78516, 4.4904, 0.00039, -0.00027, 0.00037, 0.00043, 25.74073,
                     51.98246, 40.87724, 61.51655, 108.14156, 92.12637, 64.84557,
                     62.10615, 40.50389, 37.25019, 18.91404, 12.68029, 10.36964, 8.03779,
                     1.54402, 2.2409, 11.51357, -0.00034, 0.00038, -0.00024, 0.00016,
                     16.86618, 35.45773, 25.29691, 105.38074, 146.27011, 20.26667,
                     54.91794, 44.19383, 27.08597, 8.12904, 16.25201, 37.92549, 11.8883,
                     33.1429, 1.08892, 2.70842, -2.16821, 0.00189, -0.00178, -0.00119,
                     -5e-05, 37.26188, 16.21746, 12.43047, 63.37355, 114.07611, 109.6321,
                     83.03648, 57.59037, 38.66853, 25.65676, 16.95107, 11.18371, 7.37695,
                     4.86026, 3.20141, 2.11423, 1.39385, 0.00195, -0.00042, 0.00095,
                     -0.00036, 35.96241, 15.72724, 12.05461, 61.48319, 110.66604,
                     106.35737, 80.55508, 55.86794, 37.51901, 24.89228, 16.44513,
                     10.85143, 7.15978, 4.7201, 3.1109, 2.05072, 1.35167, -6e-05,
                     0.00065, -0.00043, -0.00015, 37.13937, 16.24346, 12.45485, 63.48393,
                     114.26793, 109.8159, 83.17144, 57.69732, 38.74399, 25.70411,
                     16.99112, 11.2004, 7.38692, 4.87877, 3.21249, 2.11604, 1.39268,
                     0.00051, 0.00066, 5e-05, 6e-05, 38.72296, 16.92868, 12.98092,
                     66.17035, 119.11119, 114.47417, 86.69744, 60.12598, 40.37813,
                     26.79773, 17.71062, 11.67745, 7.70727, 5.07895, 3.34875, 2.20672,
                     1.45385, 0.00159, -0.00063, -0.00036, -0.00023, 38.71024, 16.92254,
                     12.97225, 66.15279, 119.07559, 114.4426, 86.66769, 60.11337,
                     40.36545, 26.78421, 17.6977, 11.67227, 7.69718, 5.07281, 3.34712,
                     2.20553, 1.45461, -0.00311, 0.0017, -0.00134, 0.00023, 38.75942,
                     16.9499, 12.99493, 66.2629, 119.2639, 114.61801, 86.8193, 60.20745,
                     40.42687, 26.83642, 17.73515, 11.69656, 7.71544, 5.08495, 3.35603,
                     2.20664, 1.46161, -0.00018, -0.00232, 0.00109, -1e-04, 38.84919,
                     16.98616, 13.03085, 66.41678, 119.5424, 114.89039, 87.0109, 60.34099,
                     40.52742, 26.88482, 17.77363, 11.72089, 7.73005, 5.10098, 3.36352,
                     2.21211, 1.4596, -0.00128, 0.00148, 9e-05, 4e-05)

  mig_m_correct <- matrix(mig_m_correct, nrow = 21, ncol = 20)
  colnames(mig_m_correct) <- all_years[-length(all_years)]

  mig_f_correct <- c(113.17294, 95.34564, 39.38204, 18.93728, 35.06867,
                     46.52932, 49.2666, 42.94238, 29.4034, 18.57087, 13.71191, 10.0067,
                     11.50849, 22.50025, 29.00955, 16.82217, 19.0866, 7.008, 2.73785,
                     0.47757, 0.03767, 114.89636, 97.41671, 37.98494, 15.46635, 38.29911,
                     51.15055, 53.64078, 47.62602, 20.97116, 17.19342, 17.1194, 14.47415,
                     12.182, 25.23334, 31.29857, 18.04474, 21.79088, 9.63018, 3.09953,
                     0.63464, 0.04935, 90.23263, 70.19452, 21.59118, 15.01716, 32.49304,
                     29.78558, 28.11914, 24.65858, 13.4947, 7.68482, 13.9277, 10.65373,
                     18.5043, 26.44347, 32.48546, 21.47476, 26.5331, 11.75235, 4.37523,
                     0.73784, 0.06275, 87.45873, 65.87207, 30.06125, 35.73094, 61.96567,
                     69.40305, 41.28898, 25.8574, 11.16104, 16.017, 13.62687, 22.55101,
                     27.64042, 35.00253, 32.3181, 30.18757, 31.16165, 16.01617, 5.83027,
                     1.16625, 0.08665, 90.0433, 59.82639, 40.85119, 43.55191, 71.38232,
                     73.37267, 46.14464, 24.83667, 23.58218, 16.08625, 27.44808, 15.36314,
                     28.91679, 34.69564, 32.52892, 33.0547, 30.70524, 19.84793, 8.05434,
                     1.62285, 0.14305, 70.45879, 44.53593, 25.22668, 44.41858, 60.41144,
                     28.85065, 30.61833, 12.90396, 19.50625, 12.49823, 18.0019, 21.73224,
                     29.14986, 36.63175, 38.74703, 39.06288, 36.26655, 24.87058, 11.6835,
                     2.87612, 0.29408, 65.49059, 33.03733, 23.59719, 30.06664, 51.87299,
                     24.82477, 30.4021, 13.75009, 16.81778, 10.67645, 19.12011, 27.1663,
                     31.4169, 38.5246, 41.33303, 43.85171, 39.16344, 30.2455, 15.39064,
                     4.41864, 0.55283, 76.38913, 54.36693, 35.54828, 49.22688, 66.52346,
                     59.27889, 63.23398, 46.13172, 42.4618, 24.0129, 21.68568, 25.97592,
                     32.33337, 46.0766, 45.52331, 52.26274, 44.29909, 34.37834, 17.51129,
                     5.16723, 0.72299, 68.71302, 47.87678, 42.93321, 54.105, 53.34868,
                     49.34692, 44.90459, 42.22216, 35.6324, 31.6798, 25.61224, 32.39668,
                     33.66166, 37.89778, 45.36883, 48.96906, 50.69815, 40.97165, 20.60835,
                     5.99966, 0.82751, 70.27022, 41.84107, 37.83614, 53.01117, 57.18992,
                     48.00412, 54.58493, 54.24249, 44.60592, 36.30227, 28.17995, 25.43971,
                     29.44627, 37.43619, 47.30059, 59.98545, 60.82249, 47.56603, 22.80022,
                     6.0221, 0.69949, 57.8078, 46.44909, 48.91408, 61.11895, 80.81864,
                     67.92642, 74.08341, 64.23241, 63.25721, 41.15209, 37.85057, 35.64659,
                     42.30244, 40.03094, 48.05561, 61.94085, 76.37618, 54.00946, 27.7877,
                     6.94677, 0.64071, 48.42448, 53.01343, 41.09456, 59.30546, 108.25494,
                     111.1587, 103.01067, 79.7542, 59.06802, 57.46749, 39.2409, 39.57208,
                     45.10012, 44.46262, 45.62773, 63.05435, 86.19569, 70.35971, 34.33981,
                     9.55623, 0.86984, 40.89386, 44.01259, 28.4952, 93.81769, 150.59994,
                     82.38454, 100.05553, 66.20362, 51.47925, 25.46582, 36.40836,
                     46.65738, 37.50044, 53.18551, 55.70568, 65.97926, 75.19138, 75.58003,
                     44.13133, 11.03225, 0.91927, 54.2482, 21.65495, 15.86824, 72.30964,
                     125.33065, 118.54242, 89.60123, 64.32198, 46.0959, 34.51742,
                     29.21954, 32.40938, 38.50735, 47.8148, 62.38537, 71.58288, 78.40854,
                     73.66929, 45.77276, 13.0486, 0.8355, 36.39646, 15.71378, 12.85681,
                     67.96569, 118.27622, 109.5158, 79.87071, 53.33906, 34.49321,
                     22.03458, 14.02299, 8.89904, 5.65194, 3.59177, 2.27953, 1.44727,
                     0.9191, 0.00202, -5e-05, -0.00067, 0, 37.56888, 16.22971, 13.27584,
                     70.18092, 122.1251, 113.07433, 82.46815, 55.0807, 35.60806, 22.75099,
                     14.47923, 9.1897, 5.83368, 3.69983, 2.35029, 1.49443, 0.94224,
                     -0.00131, -0.00176, 0.00112, -6e-04, 39.15, 16.91831, 13.83276,
                     73.15433, 127.28774, 117.85368, 85.95619, 57.40907, 37.11957,
                     23.71591, 15.09269, 9.58071, 6.07959, 3.86466, 2.45348, 1.55403,
                     0.9852, -0.00321, 6e-05, 0.00023, 1e-05, 39.15065, 16.91457,
                     13.8338, 73.13045, 127.25815, 117.82782, 85.94408, 57.39172,
                     37.11233, 23.7121, 15.09005, 9.584, 6.08144, 3.85953, 2.45174,
                     1.55456, 0.98354, 0.0028, -0.00075, 8e-04, -0.00055, 39.21944,
                     16.9344, 13.85223, 73.24795, 127.45332, 118.00857, 86.0759, 57.48318,
                     37.16508, 23.74261, 15.10669, 9.59866, 6.08463, 3.86688, 2.45305,
                     1.56218, 0.98279, 0.00356, 0.00229, 0.00206, -0.00028, 39.31634,
                     16.97581, 13.88592, 73.41229, 127.75319, 118.28703, 86.27359,
                     57.6223, 37.24629, 23.80269, 15.14986, 9.61932, 6.10234, 3.8796,
                     2.46, 1.55982, 0.99505, -0.00423, -0.0011, -0.00049, -3e-05)

  mig_f_correct <- matrix(mig_f_correct, nrow = 21, ncol = 20)
  colnames(mig_f_correct) <- all_years[-length(all_years)]

  mig_res <-
    mig_resid_stock(
      pop_m_mat = pop_m_mat,
      pop_f_mat = pop_f_mat,
      sr_m_mat = sr_m_mat,
      sr_f_mat = sr_f_mat,
      asfr_mat = asfr_mat,
      srb_vec = srb_vec,
      ages = ages,
      ages_fertility = ages_fertility
    )

  net_mig_m <- mig_res$mig_m
  net_mig_f <- mig_res$mig_f

  colnames(mig_m_correct) <- NULL
  colnames(net_mig_m) <- NULL

  expect_equal(
    mig_m_correct,
    net_mig_m,
    tolerance = 0.00001
  )

  colnames(mig_f_correct) <- NULL
  colnames(net_mig_f) <- NULL

  expect_equal(
    mig_f_correct,
    net_mig_f,
    tolerance = 0.00001
  )

})
